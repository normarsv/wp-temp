!function(o){"use strict";o.redux=o.redux||{},o(document).ready((function(){o.redux.wbc_importer()})),o.redux.wbc_importer=function(){var t=o(".importer-popup");t.find(".importer-popup-backdrop").on("click",(function(){t.hasClass("progress")||t.removeClass("active")})),o(".wrap-importer .import-demo-data, #wbc-importer-reimport").unbind("click").on("click",(function(e){e.preventDefault();var r=jQuery(this).closest(".theme"),p=!1,i="Import Demo Content";if("wbc-importer-reimport"==e.target.id&&(p=!0,i="Re-Import Content",jQuery(this).hasClass("rendered")||(r=jQuery(this).parents(".wrap-importer"))),!r.hasClass("imported")||0!=p){t.find(".importer-popup-plugins, .importer-popup-options").text(""),t.find("img").attr("src",""),t.find(".wbc-progress-back").remove(),t.find("img").attr("src",r.find(".wbc_image").attr("src"));for(var a=r.data("plugins"),n=0;n<a.length;n++)t.find(".importer-popup-plugins").append('<span class="importer-popup-plugin">'+a[n]+"</span>");for(var s=r.data("options"),c=0;c<s.length;c++){var d=s[c].toLowerCase().replace(/ /g,"-");t.find(".importer-popup-options").append('<label class="importer-popup-option" for="'+d+'"><input type="checkbox" id="'+d+'" value="'+d+'" checked="checked" />'+s[c]+"</label>")}if("wbc-import-12"===r.data("demo-id")){var m='<div class="importer-content-hint">';m+='<label class="importer-popup-option" for="import-all"><input type="checkbox" id="import-all" value="import-all" checked="checked" />Import everything</label>',m+='<label class="importer-popup-option" for="import-page"><input type="checkbox" id="import-page" value="import-page" />Pages</label>',m+='<label class="importer-popup-option" for="import-post"><input type="checkbox" id="import-post" value="import-post" />Posts</label>',m+='<label class="importer-popup-option" for="import-portfolio"><input type="checkbox" id="import-portfolio" value="import-portfolio" />Portfolio</label>',m+='<label class="importer-popup-option" for="import-content_block"><input type="checkbox" id="import-content_block" value="import-content_block" />Content block</label>',m+='<label class="importer-popup-option" for="import-product"><input type="checkbox" id="import-product" value="import-product" />Products</label>',m+="</div>",t.find('.importer-popup-option[for="demo-content"]').append(m)}return o(".importer-popup-option #attachments").on("change",(function(){o(this).checked?o("#generate-resized-image-copies").removeAttr("checked").parent("label").addClass("disabled"):o("#generate-resized-image-copies").parent("label").removeClass("disabled")})),o(".importer-popup-option #theme-options, .importer-popup-option #demo-content").on("change",(function(){"checked"!==o("#theme-options").attr("checked")&&"checked"!==o("#demo-content").attr("checked")?t.find(".importer-popup-import").addClass("disabled"):t.find(".importer-popup-import").removeClass("disabled")})),t.removeClass("progress"),t.addClass("active"),o(".importer-popup-import").unbind("click").on("click",(function(){function e(){var o='<div class="wbc-progress-back"><div class="wbc-progress-bar"><span class="wbc-progress-count">0%</span></div>';t.find(".importer-popup-content").append(o),setTimeout((function(){a(s)}),2e3)}function a(o){o.action="redux_wbc_importer_progress",0==c?jQuery.ajax({url:ajaxurl,data:o,success:function(e){var r=jQuery.parseJSON(e);if(e.length>0&&"object"==typeof r){var p=Math.floor(r.imported_count/r.total_post*100);p=p>0?p-1:p,t.find(".wbc-progress-bar").css("width",p+"%"),t.find(".wbc-progress-count").text(p+"%"),setTimeout((function(){a(o)}),2e3)}}}):t.find(".wbc-progress-back").remove()}var n;if(0!=confirm(i)){1==p&&r.removeClass("active imported").addClass("not-imported"),r.removeClass("active imported"),r.find(".importer-button").hide();var s=jQuery(this).data(),c=!1;s.action="redux_wbc_importer",s.demo_import_id=r.attr("data-demo-id"),s.nonce=r.attr("data-nonce"),s.type="import-demo-content",s.wbc_import=1==p?"re-importing":" ",s.options={},t.find(".importer-popup-options input").each((function(){s.options[o(this).attr("id")]="checked"===o(this).attr("checked")})),t.addClass("progress"),jQuery.post(ajaxurl,s,(function(o){if(r.find(".wbc_image").css("opacity","1"),o.length>0&&o.match(/Have fun!/gi)){if(0==p){r.addClass("rendered").find(".wbc-importer-buttons .importer-button").removeClass("import-demo-data");var t='<div id="wbc-importer-reimport" class="wbc-importer-buttons button-primary import-demo-data importer-button">Re-Import</div>';r.find(".theme-actions .wbc-importer-buttons").append(t)}r.addClass("imported active").removeClass("not-imported"),c=!0,a(s),window.onbeforeunload=null,location.reload(!0)}else r.find(".import-demo-data").show(),1==p&&(r.find(".importer-button:not(#wbc-importer-reimport)").removeClass("button-primary").addClass("button").text("Imported").show(),r.find(".importer-button").attr("style",""),r.addClass("imported active").removeClass("not-imported")),c=!0,alert("There was an error importing demo content: \n\n"+o.replace(/(<([^>]+)>)/gi,""))})),e()}})),!1}}))}}(jQuery);